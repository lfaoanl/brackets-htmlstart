define(function(){"use strict";function c(e){for(var n=e.document,t=e.getCursorPos(),i=n.getLine(t.line),r=t.ch,o=t.ch,l=!1;r>0&&/\S/.test(i.charAt(r-1));)--r;return l=n.getRange({line:t.line,ch:r},{line:t.line,ch:o}),l.match(/doctype/)&&(l=l.substring(l.match(/doctype/).index)),l===a?!0:!1}function d(e,n,t){var r=!1,d="",u=0,f=0,s=null,h=0,g=n.document.file._name;if("keydown"===t.type&&t.keyCode===i.DOM_VK_TAB&&-1!=o.indexOf(g.substr(g.lastIndexOf(".")))){if(r=c(n),r&&(d=l,f=n.getCursorPos(),u={line:f.line,ch:f.ch-a.length},n.document.replaceRange(d,u,f)),s=n._codeMirror)for(f=n.getCursorPos(),h=u.line;h<=f.line;h++)s.indentLine(h);t.preventDefault()}}function u(e,n,t){n&&$(n).on("keyEvent",d),t&&$(t).off("keyEvent",d)}var i=brackets.getModule("utils/KeyEvent"),r=brackets.getModule("editor/EditorManager"),o=[".php",".html"],l="<!DOCTYPE html>\n<html>\n<head>\n</head>\n<body>\n</body>\n</html>",a="doctype";$(r).on("activeEditorChange",u),$(r.getCurrentFullEditor()).on("keyEvent",d)});
